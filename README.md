# DC 떡밥 분석기 (DCInside Topic Analyzer)

DCInside 갤러리의 특정 기간 내 게시글을 수집하고, 핵심 토픽(떡밥)을 분석하여 시각화해주는 Chrome 확장 프로그램입니다.

<br>

## 🚀 개발 동기 (Motivation)

**Before (불편했던 점)**
DCInside 갤러리에서 특정 주제나 유행하는 '떡밥'을 파악하기 위해서는 수많은 페이지를 일일이 넘겨보며 게시글을 확인해야 했습니다. 이는 시간 소모가 크고, 어떤 주제가 얼마나 자주 언급되는지 정량적으로 파악하기 어렵다는 불편함이 있었습니다. 특히 특정 기간 동안의 트렌드를 알고 싶을 때에는 더욱 비효율적이었습니다.

**After (해결된 점)**
'DC 떡밥 분석기'를 통해 이러한 불편함을 해소했습니다. 이제 사용자는 특정 갤러리에서 원하는 기간을 설정하기만 하면, 확장 프로그램이 해당 기간의 모든 게시글을 자동으로 수집하고 제목을 분석하여 어떤 '떡밥'이 가장 많이 언급되었는지 시각적인 차트로 한눈에 보여줍니다. 이는 커뮤니티의 흐름을 빠르고 정확하게 이해하는 데 큰 도움을 줍니다.

<br>

## ✨ 주요 기능 (Features)

-   **기간 설정 분석**: 사용자가 지정한 시작일과 종료일 사이의 모든 게시글을 분석합니다.
-   **효율적인 데이터 수집**: 이진 탐색 알고리즘을 사용해 분석이 필요한 페이지 범위를 신속하게 찾아냅니다.
-   **서버 부하 최소화**: 동시 요청(Concurrency) 제한과 요청 사이의 지연(Delay)을 통해 DCInside 서버에 과도한 부하를 주지 않도록 설계되었습니다.
-   **토픽 분석 및 시각화**: 수집된 게시글 제목에서 키워드를 추출하고, 빈도수를 계산하여 어떤 주제가 많이 언급되었는지 차트로 보여줍니다.
-   **간편한 UI**: 웹 페이지에 사이드바 형태로 자연스럽게 통합되어 손쉽게 사용할 수 있습니다.

> **데모 GIF/스크린샷**: 여기에 확장 프로그램의 작동 과정을 보여주는 GIF 또는 스크린샷을 추가하세요. (예: 아이콘 클릭, 날짜 선택, 분석 결과 차트 표시 등)

<br>

## 📐 아키텍처 (Architecture)

1.  **사용자**: 확장 프로그램 아이콘을 클릭하여 사이드바를 엽니다.
2.  **`background.js`**: 아이콘 클릭을 감지하고, 현재 페이지가 DCInside 갤러리인지 확인한 후 `content.js`를 주입합니다.
3.  **`content.js`**: 페이지에 사이드바(`sidebar.html`)를 생성하고, 사이드바의 요청에 따라 게시글 데이터 수집 및 분석을 수행합니다.
    -   **갤러리 정보 탐색**: 이진 탐색으로 갤러리의 전체 페이지 수와 가장 오래된 게시글 날짜를 파악합니다.
    -   **게시글 스크래핑**: 사용자가 선택한 기간에 해당하는 페이지 범위를 다시 이진 탐색으로 정밀하게 계산한 후, 해당 페이지들의 게시글 제목과 날짜를 수집합니다.
4.  **`sidebar.js`**: 사용자로부터 날짜 입력을 받고, `content.js`에 분석을 요청합니다. `content.js`로부터 받은 결과를 `Chart.js`를 이용해 시각화하여 보여줍니다.

<br>

## 🤔 트러블 슈팅 (Troubleshooting) & 배운 점 (Lessons Learned)

#### 1. 대규모 데이터 스크래핑의 효율성과 안정성 확보

*   **문제**: DCInside 갤러리는 게시글 수가 방대하며, 사용자가 긴 기간을 설정할 경우 수천 페이지에 달하는 데이터를 스크래핑해야 합니다. 단순히 순차적으로 모든 페이지를 요청하는 방식은 시간이 매우 오래 걸리고, 서버에 과도한 부하를 주어 IP 차단 등의 문제가 발생할 위험이 있었습니다.

*   **해결**:
    *   **이진 탐색(Binary Search) 도입**: 특정 날짜 범위에 해당하는 게시글이 시작되는 페이지와 끝나는 페이지를 효율적으로 찾기 위해 이진 탐색을 활용했습니다. 이는 불필요한 페이지 요청을 대폭 줄여 필요한 데이터만 스크래핑할 수 있도록 했습니다.
    *   **동시 요청 제한 및 지연(Concurrency Control & Delay)**: 웹 스크래핑 시 서버에 부담을 주지 않기 위해 `Promise.allSettled`와 함께 `CONCURRENT_LIMIT`를 두어 동시에 요청하는 페이지 수를 제한했습니다. 또한, 각 배치(batch) 요청 사이에 `MIN_DELAY_BETWEEN_BATCHES`와 `MAX_DELAY_BETWEEN_BATCHES` 사이의 무작위 지연을 추가하여 자연스러운 요청 흐름을 시뮬레이션하고 서버의 감지를 피할 수 있도록 했습니다.

*   **결과**: 불필요한 트래픽을 최소화하고, 안정적으로 대량의 게시글 데이터를 수집할 수 있는 견고한 스크래핑 로직을 구현했습니다. 이는 확장 프로그램의 사용자 경험과 서버 운영의 지속 가능성 모두를 확보하는 데 기여했습니다.

#### 2. Chrome 확장 프로그램의 동적인 콘텐츠 주입 및 통신

*   **문제**: 확장 프로그램의 핵심 기능인 사이드바 UI를 사용자가 방문한 웹 페이지에 동적으로 주입하고, 이 주입된 UI(사이드바)와 백그라운드 스크립트, 그리고 웹 페이지의 콘텐츠 스크립트 간에 유기적인 통신이 필요했습니다. 특히, 사용자가 확장 프로그램 아이콘을 클릭하기 전에 이미 페이지를 로드한 경우 `content.js`가 주입되지 않아 사이드바가 작동하지 않는 문제가 발생할 수 있었습니다.

*   **해결**:
    *   **`background.js`의 역할**: `chrome.action.onClicked` 리스너를 활용하여 확장 프로그램 아이콘 클릭 이벤트를 처리하고, `chrome.scripting.executeScript`를 사용하여 필요한 시점에 `content.js`를 페이지에 주입하도록 했습니다.
    *   **메시지 기반 통신**: `chrome.runtime.sendMessage`와 `chrome.runtime.onMessage.addListener`를 사용하여 `background.js`, `content.js`, `sidebar.js` 간에 메시지를 주고받는 방식을 구현했습니다. 이를 통해 사이드바 토글, 갤러리 정보 요청, 데이터 분석 요청 등의 비동기 작업을 안전하게 처리할 수 있었습니다.
    *   **주입 상태 추적**: `injectedContentScripts` 맵을 `background.js`에 두어 어떤 탭에 `content.js`가 주입되었는지 추적하고, `pendingToggleTabs`를 통해 아이콘 클릭이 먼저 발생한 경우에도 `content.js` 주입 후 사이드바가 자동으로 열리도록 처리하여 사용자 경험을 개선했습니다.

*   **결과**: Chrome 확장 프로그램 환경에서 다양한 컴포넌트 간의 복잡한 비동기 통신을 효과적으로 관리하고, 사용자 인터랙션에 따라 동적으로 콘텐츠를 주입하여 기능을 제공하는 방법을 학습하고 적용했습니다.

<br>

## 🛠️ 기술 스택 (Tech Stack)

-   **Core**: `JavaScript (ES6+)`, `HTML5`, `CSS3`
-   **Platform**: `Chrome Extension API (Manifest V3)`
-   **Libraries**: `Chart.js` (데이터 시각화)
-   **Algorithms**: Binary Search (페이지 탐색 최적화)

<br>

## 📂 디렉토리 구조

```
.
├── background.js              # 확장 프로그램의 이벤트 관리 (아이콘 클릭 등)
├── content.js                 # DCInside 페이지에 직접 주입되어 핵심 로직 수행 (데이터 스크래핑, 사이드바 관리)
├── sidebar.html               # 분석기 UI 마크업
├── sidebar.js                 # UI 이벤트 처리 및 차트 생성 (content.js와 통신)
├── sidebar.css                # UI 스타일
├── manifest.json              # 확장 프로그램의 설정 파일
└── lib/
    └── chart.umd.js           # Chart.js 라이브러리
```

<br>

## 🚀 설치 및 사용법 (For Developers)

1.  이 저장소를 로컬 컴퓨터에 복제(clone)합니다.
2.  Chrome 브라우저에서 `chrome://extensions` 주소로 이동합니다.
3.  우측 상단의 '개발자 모드(Developer mode)'를 활성화합니다.
4.  '압축 해제된 확장 프로그램을 로드합니다(Load unpacked)' 버튼을 클릭합니다.
5.  프로젝트 폴더를 선택하여 확장 프로그램을 로드합니다.
6.  DCInside 갤러리 페이지로 이동하여 브라우저의 확장 프로그램 아이콘을 클릭하면 사이드바가 나타납니다.